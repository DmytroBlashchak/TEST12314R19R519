# Правила гри та протокол обміну між ПК та STM32

## 1. Загальні правила гри

- Гравець керує змійкою за допомогою комбінації клавіш на ПК.
- Мета гри — набрати якомога більше очок, збираючи бонуси.
- Гра завершується у таких випадках:
  - Змійка врізається у стінку.
  - Змійка врізається у саму себе.
- Кожен рух змійки супроводжується передачею координат у STM32.

## 2. Формат протоколу обміну даними

### 2.1. Формат команди (від ПК до STM32)

Команда передається у вигляді пакета:

```
[Команда] [Дані] [Контрольна сума]
```

- **Команда** — код операції (1 байт)
- **Дані** — зміст команди (залежить від операції)
- **Контрольна сума** — для перевірки коректності пакета

Приклад команди для руху змійки:

```
0x01 [X-координата] [Y-координата] [Контрольна сума]
```

### 2.2. Формат відповіді (від STM32 до ПК)

```
[Код статусу] [Дані] [Контрольна сума]
```

- **Код статусу** — повідомлення про успішність виконання команди
- **Дані** — відповідь на запит
- **Контрольна сума** — перевірка цілісності пакета

Приклад відповіді:

```
0x00 (успішно виконано)
```

## 3. Обробка помилок

STM32 може генерувати наступні коди помилок:

| Код  | Опис                      |
| ---- | ------------------------- |
| 0x01 | Некоректна команда        |
| 0x02 | Помилка контрольної суми  |
| 0x03 | Аварійне перезавантаження |

У разі помилки ПК має повторно надіслати останню команду.

## 4. Обробка затримок і втрати пакетів

- Якщо команда не отримана STM32 або контрольна сума неправильна, ПК має повторити запит.
- Інтервал між командами має бути не менше **X мс**, щоб уникнути перевантаження порту.
- При зупинці гри STM32 надсилає ПК запит на підтвердження виходу:

```
0x05 (Запит на завершення)
```

ПК має підтвердити завершення командою:

```
0x06 (Підтвердження завершення)
```

## 5. Завершення гри

Якщо гра завершується через аварійну ситуацію, STM32 надсилає код завершення разом із причиною. Приклад:

```
0x07 [Причина завершення] [Контрольна сума]
```

---

Цей протокол забезпечує чіткий обмін даними між ПК та STM32 і гарантує стабільність гри.

